## 部署智能合约到通道

用户通过调用智能合约与区块链账本进行交互，在`Hyperledger Fabric` 中智能合约部署在packages中简称链码`chaincode`, 组织验证交易或查询账本需要安装`chaincode`到它们的`peers`中，当链码安装到加入了通道（`channel`）的`peers`中，通道成员可以部署`chaincode`到该通道和使用`chaincode`中的智能合约创建或更新资产到通道中的账本

使用`Fabric`链码生命周期来部署链码到通道，链码生命周期允许多个组织在创建交易之前如何操作链码达成共识

虽然背书策略指定了哪些组织需要执行链码来验证交易，但通道成员需要使用 Fabric 链码生命周期来就链码背书策略达成一致。 有关如何在通道上部署和管理链代码的更深入概述，请参阅[Fabric chaincode lifecycle](https://hyperledger-fabric.readthedocs.io/en/latest/chaincode_lifecycle.html).。

这篇文章将使用链码生命周期来部署`asset-transfer (basic) chaincode ` 到测试网的通道中,` Fabric chaincode lifecycle `版本为v2.4

### 开启网络

```bash
cd fabric-samples/test-network
./network.sh down	#关闭正在运行的docker 容器 移除之前生成的artifacts
./network.sh up createChannel # 开启测试网络，创建通道，并让Org1和Org2加入到创建的`mychannel`中
```

使用`Peer CLI`来部署 `asset-transfer(basic)`链码到通道中，步骤如下

- 打包只能合约（下载所需依赖）
- 安装链码包
- 比准链码定义
- 提交链码定义到通道中

### 开启日志（可选）

使用`logsout tool` 工具来监听智能合约日志输出，该工具会收集不同的`docker`容器的输出到一个地方，更好的并帮助管理人员`debug`问题

开启命令：

```bash
cd fabric-samples/test-network
./monitordocker.sh fabric_test
```

### 打包智能合约

这里使用`Go`版本

进入到`fabric-samples`项目的`chaincode-go`目录

```bash
cd fabric-samples/asset-transfer-basic/chaincode-go
```

使用`go mudule`安装依赖，依赖在`go.mod`中可看到，设置`go 环境变量 GO111MODILE=on` 然后安装依赖到`vendor`中

```bash
go env -w GO111MODULE=on
go mod vendor
```























